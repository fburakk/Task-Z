<div class="kanban-board">
    <!-- Board Header -->
    <div class="board-header">
        <h1>{{ board?.name }}</h1>
        <button class="btn btn-primary" (click)="openStatusModal()">Yeni Liste Ekle</button>
    </div>

    <!-- Kanban Columns -->
    <div class="board-columns">
        <div class="status-column" *ngFor="let status of statuses">
            <div class="column-header">
                <h3>{{ status.title }}</h3>
                <span class="task-count">{{ (tasksByStatus[status.id] || []).length }}</span>
            </div>
            <div class="task-list">
                <div class="task-card" *ngFor="let task of (tasksByStatus[status.id] || [])">
                    <div class="task-header">
                        <span class="priority-badge" [ngClass]="getPriorityClass(task.priority)">
                            {{ task.priority }}
                        </span>
                        <span class="task-id">#{{ task.id }}</span>
                    </div>
                    <h4 class="task-title">{{ task.title }}</h4>
                    <p class="task-description">{{ task.description }}</p>
                    <div class="task-footer">
                        <div class="assignee" *ngIf="task.assigneeUsername">
                            <span class="assignee-label">Assigned to:</span>
                            <span class="assignee-name">{{ task.assigneeUsername }}</span>
                        </div>
                        <div class="due-date" *ngIf="task.dueDate">
                            <span class="due-date-label">Due:</span>
                            <span class="due-date-value">{{ task.dueDate | date:'shortDate' }}</span>
                        </div>
                    </div>
                </div>
                <div class="add-task-placeholder" (click)="openTaskModal(status.id)">
                    + Add a task
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Status Modal -->
<div *ngIf="isStatusModalOpen" class="modal">
    <div class="modal-background" (click)="closeStatusModal()"></div>
    <div class="modal-content">
        <div class="modal-box">
            <button class="close-button" (click)="closeStatusModal()">×</button>
            <h3 class="modal-title">Yeni Liste Ekle</h3>
            
            <input
                class="modal-input"
                [(ngModel)]="newStatusName"
                type="text"
                placeholder="Liste adını girin"
                name="statusName"
                required
            />

            <div class="modal-buttons">
                <button class="modal-button create" (click)="createStatus()">Oluştur</button>
                <button class="modal-button cancel" (click)="closeStatusModal()">İptal</button>
            </div>
        </div>
    </div>
</div>

<!-- Task Modal -->
<div *ngIf="isModalOpen" class="modal">
    <div class="modal-background" (click)="closeTaskModal()"></div>
    <div class="modal-content">
        <div class="modal-box">
            <button class="close-button" (click)="closeTaskModal()">×</button>
            <h3 class="modal-title">Yeni Görev Ekle</h3>
            
            <input
                class="modal-input"
                [(ngModel)]="newTaskTitle"
                type="text"
                placeholder="Görev başlığı"
                name="taskTitle"
                required
            />

            <textarea
                class="modal-input"
                [(ngModel)]="newTaskDescription"
                placeholder="Görev açıklaması"
                name="taskDescription"
                required
            ></textarea>

            <select
                class="modal-input"
                [(ngModel)]="newTaskPriority"
                name="taskPriority"
                required
            >
                <option value="low">Düşük Öncelik</option>
                <option value="medium">Orta Öncelik</option>
                <option value="high">Yüksek Öncelik</option>
            </select>

            <input
                class="modal-input"
                [(ngModel)]="newTaskDueDate"
                type="date"
                placeholder="Son tarih"
                name="taskDueDate"
            />

            <select
                class="modal-input"
                [(ngModel)]="newTaskUsername"
                name="taskUsername"
            >
                <option value="">Görev atanacak kişiyi seçin</option>
                <option *ngFor="let user of boardUsers" [value]="user.username">
                    {{ user.username }}
                </option>
            </select>

            <div class="modal-buttons">
                <button class="modal-button create" (click)="createTask()">Oluştur</button>
                <button class="modal-button cancel" (click)="closeTaskModal()">İptal</button>
            </div>
        </div>
    </div>
</div>
